# í•©ì„±ë°ì´í„° ê¸°ë°˜ ê°ì²´ íƒì§€ AI ê²½ì§„ëŒ€íšŒ

## ğŸ† Result
# **Public score 2nd** 0.99647 | **Private score 2nd** 0.99403  
1ë“±ê³¼ 0.00001ì°¨ì´...

ì£¼ìµœ : Visol

ì£¼ê´€ : DACON

ê·œëª¨ : LB 2ë“±/1400



===========================================================================
  
  
    
  
  
âœï¸
## **ëŒ€íšŒ ëŠë‚€ì **
 - ì•„ì´ë””ì–´ë¥¼ ì œì¼ ì˜ ì‚´ë ¸ë˜ ëŒ€íšŒë¼ê³  ìƒê°í•©ë‹ˆë‹¤.
   ê³µì • ê³¼ì • ì¤‘ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ìƒí™©ì´ ì¡´ì¬í•  ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê³  ë°ì´í„°ì— ì ‘ê·¼í•˜ì˜€ëŠ”ë°
   1. **ê¸°ê³„ ë§ˆëª¨**: ê¸°ê³„ê°€ ì˜¤ë˜ë˜ê±°ë‚˜ ë§ˆëª¨ë˜ë©´, ê·¸ ì„±ëŠ¥ì´ ì €í•˜ë˜ê³ , ì´ë¡œ ì¸í•´ ìˆ˜ì§‘ëœ ë°ì´í„°ì˜ ì‹ ë¢°ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   2. **ë°ì´í„° ì¼ê´€ì„± ë¶€ì¡±**: ê³µì •ì´ ë³€ê²½ë˜ê±°ë‚˜, ì¥ë¹„ê°€ êµì²´ë˜ê±°ë‚˜, ì›ì¬ë£Œ í’ˆì§ˆì´ ë³€ë™ë˜ëŠ” ë“±ì˜ ì´ìœ ë¡œ ë°ì´í„° ê°„ì˜ ì¼ê´€ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¶„ì„ì„ ë³µì¡í•˜ê²Œ ë§Œë“¤ë©°, ì˜ëª»ëœ ê²°ë¡ ì„ ë‚´ë¦´ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
   3. **ì„¼ì„œ ì˜¤ë¥˜ ë˜ëŠ” ê²°í•¨**: ê¸°ê³„ì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ì£¼ëœ ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì„¼ì„œê°€ ê²°í•¨ì´ ìˆê±°ë‚˜ ì˜¤ì‘ë™í•˜ë©´, ë°ì´í„°ê°€ ì™œê³¡
   4. **í™˜ê²½ì  ìš”ì¸**: í™˜ê²½ì  ë…¸ì´ì¦ˆë„ ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì˜¨ë„, ìŠµë„, ê¸°ì•• ë“±ì˜ ë³€í™”ëŠ” ì„¼ì„œì˜ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹˜ê³ , ì´ëŠ” ë°ì´í„°ì— ë…¸ì´ì¦ˆë¥¼ ë”í•˜ëŠ” ê²°ê³¼
  
   ìœ„ì™€ ê°™ì€ ì´ìœ ë“¤ë¡œ ë°ì´í„°ì˜ ë…¸ì´ì¦ˆë¥¼ ì¤„ì´ëŠ”ê²Œ ì œì¼ ì¤‘ìš”í•œ ëŒ€íšŒë¼ê³  íŒë‹¨ì„ í•˜ì—¬ì„œ  
   **kalman filter, moving average, low-pass filter**ì™€ ê°™ì€ ì—¬ëŸ¬ ìŠ¤ë¬´ë”© ê¸°ë²•ë“¤ì„ ì‚¬ìš©í•˜ì˜€ê³ ,  
   ê·¸ ì¤‘ì—ì„œ kalman filter ì ìš© ì‹œ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ê²Œ ìƒìŠ¹í•˜ì˜€ìŠµë‹ˆë‹¤.  
   kalman filterëŠ” 'ì˜ˆì¸¡'ê³¼ 'ì—…ë°ì´íŠ¸'ë¼ëŠ” ë‘ ë‹¨ê³„ë¥¼ ë°˜ë³µí•˜ëŠ”ë°, ì‹œìŠ¤í…œì˜ ë™ì  ëª¨ë¸ê³¼ ê°€ìš°ì‹œì•ˆ ë…¸ì´ì¦ˆì˜ í†µê³„ì  íŠ¹ì„±ì„ ì´ìš©í•´ 'ì˜ˆì¸¡' ë‹¨ê³„ì—ì„œëŠ” ì‹œìŠ¤í…œì˜ ë‹¤ìŒ ìƒíƒœë¥¼ ì˜ˆì¸¡í•˜ê³ , 'ì—…ë°ì´íŠ¸' ë‹¨ê³„ì—ì„œëŠ” ìƒˆë¡œìš´ ì¸¡ì • ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ ì´ ì˜ˆì¸¡ì„ ì¡°ì •í•˜ê¸° ë•Œë¬¸ì—  
   ì¸¡ì • ì˜¤ì°¨ ë³´ì • + ì‹œê³„ì—´ ë°ì´í„° íŠ¹ì„± + ìê¸° ìƒê´€ì„± ìš”ì†Œë¥¼ ë°˜ì˜í•˜ê¸° ìœ„í•´
   kalman filterë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

   ë˜í•œ ì´ëŸ¬í•œ ë°ì´í„° íŠ¹ì„±ì„ í™œìš©í•˜ê¸° ìœ„í•´
   ì¼ë°˜ì ì¸ K-Fold ë°©ì‹ì´ ì•„ë‹Œ, Stratify K-Fold ë°©ë²•ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
   ë°ì´í„°ì˜ ê° ì£¼ê¸°ì— classë¥¼ ë¶€ì—¬í•˜ì—¬ Stratify í˜•ì‹ìœ¼ë¡œ í•™ìŠµì„ ì§„í–‰í•˜ì˜€ê³ 
   ì´ ì „ê³¼ ë¹„êµí•´ì„œ ì„±ëŠ¥ í–¥ìƒì— í° ë„ì›€ì„ ì£¼ì—ˆìŠµë‹ˆë‹¤.

   ë˜í•œ Shapely Valueë¥¼ í™œìš©í•´ì„œ ì£¼ìµœì‚¬ì—ê²Œ ì–´ë– í•œ ë³€ìˆ˜ë“¤ì´ ì œì¼ ì¤‘ìš”í–ˆëŠ”ì§€ ì•Œë ¤ì£¼ì—ˆëŠ”ë°
   ì´ë¥¼ í†µí•´ XAIë¥¼ ì²˜ìŒ ì ‘í•˜ê²Œ ë˜ì–´ ë§¤ìš° í¥ë¯¸ë¡œì› ìŠµë‹ˆë‹¤.

   ì´ë²ˆ ëŒ€íšŒë¥¼ í†µí•´ ë°ì´í„°ì— Domainì„ í™œìš©í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ë°°ì› ë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.
   ê°€ì„¤ì„ ì„¸ìš°ê³  ê·¸ê±¸ ì„±ëŠ¥ê³¼ ë“±ìˆ˜ë¥¼ í†µí•´ ê²€ì¦ë°›ëŠ” ê²½í—˜ì€ ì •ë§ ì§œë¦¿í–ˆìŠµë‹ˆë‹¤.
   ë¹„ë¡ Data-Leakageë¡œ ìˆ˜ìƒì„ í•˜ì§€ëŠ” ëª»í•˜ì˜€ì§€ë§Œ
   ì•½ 2000ì—¬ëª… ì¤‘ 1ë“±ì˜ ì˜ˆì¸¡ë ¥ì„ ê°€ì§€ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì—ˆë‹¤ëŠ” ì‚¬ì‹¤ì—
   ë‹¤ìŒ ëŒ€íšŒì—ì„œëŠ” ê¼­ Data-Leakage ì´ìŠˆì— íœ˜ë§ë¦¬ì§€ ì•Šê³ 
   ìˆ˜ìƒì„ í•˜ê² ë‹¤ë¼ê³  ë‹¤ì§ì„ í•˜ê²Œ ë˜ëŠ” ëŒ€íšŒì˜€ìŠµë‹ˆë‹¤.
   
===========================================================================

### í•©ì„± ë°ì´í„°ë¥¼ í™œìš©í•œ ìë™ì°¨ íƒì§€ AI ëª¨ë¸ ê°œë°œ
- í•©ì„±ë°ì´í„°ë€ ì‹¤ì œ í™˜ê²½ì—ì„œ ìˆ˜ì§‘ë˜ê±°ë‚˜ ì¸¡ì •ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë””ì§€í„¸ í™˜ê²½ì—ì„œ ìƒì„±ë˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ,  ìµœê·¼ ë°©ëŒ€í•œ ì–‘ì§ˆì˜ ë°ì´í„°ì…‹ì´ í•„ìš”í•´ì§ì— ë”°ë¼ ê·¸ ì¤‘ìš”ì„±ì´ ëŒ€ë‘ë˜ê³  ìˆìŠµë‹ˆë‹¤.

- í•©ì„± ë°ì´í„°ëŠ” ë°ì´í„° ë¼ë²¨ë§ ì‘ì—…ì„ ìœ„í•œ 2ë°° ì´ìƒì˜ ì‹œê°„ ì ˆì•½ê³¼ 10ë°° ê°€ê¹Œìš´ ë¹„ìš©ì„ ì ˆê°í•˜ê²Œ í•˜ê³ , ìë™í™”ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •í™•í•œ ë¼ë²¨ë§ì˜ ë°ì´í„° ê·¸ë¦¬ê³  ì •í™•í•œ AI ëª¨ë¸ ê°œë°œì„ ìœ„í•œ ë°ì´í„°ì˜ ë‹¤ì–‘í™”ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
- í•™ìŠµìš© í•©ì„±ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ `ìë™ì°¨ íƒì§€ë¥¼ ìˆ˜í–‰í•˜ëŠ” AI ëª¨ë¸`ì„ ê°œë°œí•´ì•¼ í•©ë‹ˆë‹¤.


## Project structure
```
Synthetic-Data-Object-Detection
â”œâ”€ .gitignore
â”œâ”€ archive  # implementation pytorch 
â”œâ”€ data  
â”‚  â”œâ”€ raw
â”‚  â”‚  â””â”€ raw data
â”‚  â”œâ”€ ensemble
â”‚  â”‚  â””â”€ ensemble data
â”‚  â””â”€ submission
â”œâ”€ models
â”‚  â””â”€ model file
â”œâ”€ mmdetection
â”‚  â”œâ”€ configs  
â”‚  â”‚  â”œâ”€ _base_  
â”‚  â”‚  â””â”€ visol  # model config
â”‚  â”‚      â””â”€ model config file.py
â”‚  â””â”€ mmdet
â”œâ”€ mmdetection3.x/
â”œâ”€ inference.py # Test Inference
â”œâ”€ grad_cam.py  # GradCam
â”œâ”€ ensemble.py  # weighted boxes fusion
â””â”€ README.md
```
## Getting Started
`Python 3.8.10` `mmdetection 2.x`
```
git clone https://github.com/Myungbin/Synthetic-Data-Object-Detection.git

python -m pip install --upgrade pip
python -m pip install -r requirements.txt

cd mmdetection
python .\tools\train.py .\configs\visol\{config_file.py}
python .\tools\test.py '{config_file_path}' '{model_result_path}' --format-only --out '{result_path}'
```
## Data
[Dataset Link](https://dacon.io/competitions/official/236107/data)  
The project utilizes a custom dataset for training and evaluation.
The dataset consists of labeled images with bounding box annotations for each object of interest.
The dataset is not included in this repository and needs to be prepared separately.


## Experiment
The default augmentations used were `Resize`, `Flip`, and `Normalize`.  
Faster R-CNN, EfficientDet, Swin Transformer, Libra R-CNN, and YOLO were used in the experiment. You can check the other experiments in the "finished_experiments" folder. In the end, `Cascade R-CNN` models was used.  

| Model         | Backbone | Depth | Augmentation                                      |  mAp |
|---------------|----------|-------|---------------------------------------------------|------|
| Cascade R-CNN | SwinT    | -     | Mixup, Cutout                                     | 0.89 |
| Libra R-CNN   | Resnest  | 200   | Mixup, Cutout, AutoAugment, PhotoMetricDistortion | 0.89 |
| Faster R-CNN  | ResNeXt  | 101   | Mixup                                             | 0.91 |
| Faster R-CNN  | ResNeSt  | 200   | Mixup                                             | 0.93 |
| Faster R-CNN  | ResNeSt  | 101   | Mixup, Cutout                                     | 0.95 |
| Cascade R-CNN | ResNeSt  | 200   | Mixup, Cutout, AutoAugment, PhotoMetricDistortion | 0.98 |
| ...           | ...      | ...   | ...                                               | ...  |

#### Ensemble
`Weighted-Boxes-Fusion` on the results of 8 models.

#### pretrain model
You can check the pretrained model weights [google drive](https://drive.google.com/drive/folders/1YaCBzoYmnUIbbKk2q81_x9H-RuYfxUxI?usp=sharing)  

## Result
Public mAp `0.9964`  Private mAP `0.99403`  

To reproduce the results of a public mAP of 0.9964 and a private mAP of 0.99403, follow these steps  
1. [v7.py](https://github.com/Myungbin/Synthetic-Data-Object-Detection/blob/main/mmdetection3.x/configs/visol/v7.py) must be trained and inferred using a seed of **2023** and the **NVIDIA RTX 4090** GPU. 
Additionally, this file utilizes `mmdetection 3.x`, it should be executed based on the following [document](https://mmdetection.readthedocs.io/en/latest/get_started.html).
2. In the [final folder](https://github.com/Myungbin/Synthetic-Data-Object-Detection/tree/main/mmdetection/configs/visol/final), `v3.py` must be trained and inferred using a seed of **1927851590** and the **NVIDIA RTX 3090** GPU.
3. `For all other cases` must be trained and inferred using a seed of **378452678** and the **NVIDIA A100** GPU.  
4. Finally, You must ensemble the inference results of each model using Weighted-Boxes-Fusion. 
The weights for models v1 to v8 are [0.05, 0.05, 0.05, 0.05, 0.2, 0.2, 0.2, 0.2].
 
You can find detailed information about the experimental results through the PowerPoint presentation.

## Development Environment
```
OS: Window11
CPU: Intel i9-11900K
RAM: 128GB
GPU: NVIDIA GeFocrce RTX3090 & RTX4090 & A100 & V100
```

## Host
- ì£¼ìµœ : ë¹„ì†”(VISOL)  
- ì£¼ê´€ : ë°ì´ì½˜(DACON)
- ê¸°ê°„ : 2023.05.08 ~ 2023.06.19 09:59  
[Competition Link](https://dacon.io/competitions/official/236107/overview/description)
